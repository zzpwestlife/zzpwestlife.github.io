---
title: 几个小问题 201806
date: 2018-06-08 10:26:57
tags: trivia
---

## Linux warning: setlocale: LC_CTYPE: cannot change locale (UTF-8): No such file or directory

这个问题经常遇到，记录一下，解决方法也很简单

```
vi /etc/environment

# add these lines...

LANG=en_US.utf-8
LC_ALL=en_US.utf-8
```

## mac ssh 连接服务器，vim 文件内的中文为乱码
 
iterm 配置utf8编码，本地终端中文不乱码，ssh远程中文乱码

遇到了同样的问题，主要是远程服务器的语言编码与终端的编码不一致。
在远程服务器端的  `~/.bashrc` 文件里面加入以下代码：
`export LANG='UTC-8'export LC_ALL='en_US.UTF-8'`
然后source一下，中文就可以正常显示。
下次登录 `.bashrc` 文件自动运行，中文照样正常显示。

## nginx access_log

其实网上说的 access_log /dev/null; 只是针对nginx的error_log而言的。如果想关闭error_log，那么就用error_log /dev/null（看老外是这么做的）。

但是想关闭access_log的话，直接在nginx.conf的http模块中配置`access_log off`;即可。

需要注意的是，已经继承了http模块的那些模块不要再设置access_log off;了。 

比如，我已经在http模块中设置了access_log off;，那么就不要在http模块所包含的server模块或location模块中设置access_log off;，以及虚拟主机目录(vhost)下的配置文件也不要添加access_log off;。


## composer 内存限制解除

`php -d memory_limit=-1 composer.phar install`

## mac 允许安装 app

`sudo spctl --master-disable`

## 搬瓦工 ss 面板

`main-exec.php?mode=extras_shadowsocks`

## mac 微信动图目录

`/Users/ZouZhipeng/Library/Containers/com.tencent.xinWeChat/Data/Library/Application Support/com.tencent.xinWeChat/2.0b4.0.9/a3ac8c8fd9e2cbceb1e690f6bcbf8741/Stickers/File`

## vim 统计字符串个数

`:%s/字符串/&/gn`

## vim 未使用 root 用户时， sudo 保存退出

`:w !sudo tee %`

## mac text 文件乱码问题

`iconv -c -f GB2312 -t UTF-8 [你要看的文件] >> [新文件的名称]`

## MySQL密码的恢复方法

- 修改MySQL的登录设置： `# sudo vi /etc/my.cnf` 在[mysqld]的段中加上一句：`skip-grant-tables` 保存并且退出vi。
- 重新启动mysqld `# /etc/init.d/mysqld restart  ( sudo service mysqld restart )`
- 用以下命令启动MySQL，以不检查权限的方式启动； `mysqld --skip-grant-tables &`
- 然后用空密码方式使用root用户登录 MySQL； `mysql -u root`

`mysql> USE mysql;`

> 注意： mysql 5.7 用户密码字段改为了 `authentication_string`  
```
mysql> update user set authentication_string=PASSWORD('zzp123456') where User='root';
mysql> flush privileges;
mysql> quit
```

- 将MySQL的登录设置修改回来 `# vi /etc/my.cnf` 将刚才在[mysqld]的段中加上的 `skip-grant-tables` 删除 保存并且退出vi。
- 重新启动mysqld `# /etc/init.d/mysqld restart   ( service mysqld restart )`
- 恢复服务器的正常工作状态

将步骤一中的操作逆向操作。恢复服务器的工作状态。


## mysql 密码过于简单的问题

Building on the answer from Sharfi, edit the `/etc/my.cnf` file and add just this one line:
`validate_password_policy=LOW`

That should sufficiently neuter the validation as requested by the OP. You will probably want to restart mysqld after this change. Depending on your OS, it would look something like:
`sudo service mysqld restart`

`mysql> SET PASSWORD = PASSWORD('your_new_password');`



## vagrant up 的问题

```
Vagrant was unable to mount VirtualBox shared folders. This is usually
because the filesystem "vboxsf" is not available. This filesystem is
made available via the VirtualBox Guest Additions and kernel module.
Please verify that these guest additions are properly installed in the
guest. This is not a bug in Vagrant and is usually caused by a faulty
Vagrant box. For context, the command attempted was:

mount -t vboxsf -o uid=1000,gid=1000 home_vagrant_www /home/vagrant/www

The error output from the command was:

/sbin/mount.vboxsf: mounting failed with the error: No such device
```

I have been able to workaround this by logging on with with `vagrant ssh` and running a`sudo yum update -y`


Then once that completed I disconnected from ssh `vagrant halt` and re-ran `vagrant reload --provision`
The guest-additions were then showing as running OK `vagrant up`.


## 删除 time machine 备份

所有： `sudo tmutil delete /Volumes/17702250105T2/Backups.backupdb`
时间很长，慢慢等

指定：`sudo tmutil delete /Volumes/17702250105T2/Backups.backupdb/志鹏’s MacBook Pro/2017-01-07-002750`

Total deleted: 431.3G 用时 20小时左右


## 允许mysql远程访问

在安装mysql的机器上运行：

进入MySQL服务器
`mysql -h localhost -u root`

赋予任何主机访问数据的权限
`mysql>GRANT ALL PRIVILEGES ON *.* TO 'root'@'%' WITH GRANT OPTION`

使修改生效
`mysql>FLUSH PRIVILEGES`

退出MySQL服务器
`mysql>exit`
